% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pairwise_analysis.R
\name{ENSEMBLE.DEE}
\alias{ENSEMBLE.DEE}
\title{Differential Enhancer Expression (DEE) Analysis using DESeq2}
\usage{
ENSEMBLE.DEE(
  eRNA.counts,
  meta_data,
  contrast,
  round.counts = TRUE,
  min.countsum = 10
)
}
\arguments{
\item{eRNA.counts}{A numeric matrix of eRNA counts. Row names should represent enhancer identifiers (GHid)
and column names should represent sample names.}

\item{meta_data}{A data frame containing metadata for each sample. Row names of \code{meta_data} must match the column
names of \code{eRNA.counts}.}

\item{contrast}{A character vector with three elements specifying the contrast for the DESeq2 analysis.}

\item{round.counts}{Logical. If \code{TRUE} (default), the raw counts are rounded to the nearest integer.}

\item{min.countsum}{Numeric. Minimum total counts required for an enhancer to be retained (default is 10).}
}
\value{
A data frame containing the differential expression results, sorted by adjusted p-value (\code{padj}),
  with a column \code{GHid} for enhancer identifiers.
}
\description{
Performs differential enhancer expression (DEE) analysis for eRNA using the DESeq2 package.
Raw counts, sample metadata, and a contrast vector are required. The contrast vector must be a character vector
with exactly three elements: the name of a factor in the design formula, the numerator level (for the fold change),
and the denominator level. For example, \code{contrast = c("group", "case", "control")}.
}
\details{
This function first subsets the eRNA counts matrix to include only the samples present in the metadata.
If \code{round.counts} is \code{TRUE}, counts are rounded. A DESeq2 dataset is then created using the design formula
\code{~ group}. Enhancers with very low counts (row sums less than \code{min.countsum}) are filtered out before running
the DESeq2 pipeline. Finally, the DESeq2 results for the specified contrast are extracted, converted to a data frame,
and sorted by adjusted p-values.
}
