% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_prep.R
\name{exp_loci2Ghid_sparse}
\alias{exp_loci2Ghid_sparse}
\title{Map Locus-Indexed Enhancer Expression to GeneHancer IDs (Sparse-friendly)}
\usage{
exp_loci2Ghid_sparse(
  enhancer.exp,
  GH.saf,
  collapse.rows = TRUE,
  agg = c("trimmed_mean", "mean", "sum"),
  trim = 0.1,
  return_sparse = TRUE
)
}
\arguments{
\item{enhancer.exp}{Numeric matrix/data.frame or a Matrix::dgCMatrix/dgTMatrix.
Rownames must be "chr:start-end".}

\item{GH.saf}{data.frame with columns Chr, Start, End, GeneID.}

\item{collapse.rows}{logical; if TRUE, aggregate loci mapping to the same GeneID.}

\item{agg}{One of c("trimmed_mean","mean","sum"). Default: "trimmed_mean"
(for compatibility); for huge matrices prefer "mean" or "sum".}

\item{trim}{Proportion to trim from each tail when agg = "trimmed_mean". Default 0.1.}

\item{return_sparse}{If TRUE and possible, return a sparse Matrix (dgCMatrix).
For agg %in% c("mean","sum"), sparse is always used.}
}
\value{
When input is sparse and collapse.rows=TRUE, returns a sparse dgCMatrix by default.
        Otherwise returns a base matrix/data.frame analogous to the original.
}
\description{
Map Locus-Indexed Enhancer Expression to GeneHancer IDs (Sparse-friendly)
}
