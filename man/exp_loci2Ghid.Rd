% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_prep.R
\name{exp_loci2Ghid}
\alias{exp_loci2Ghid}
\title{Map Locus-Indexed Enhancer Expression to GeneHancer IDs}
\usage{
exp_loci2Ghid(enhancer.exp, GH.saf, collapse.rows = TRUE)
}
\arguments{
\item{enhancer.exp}{A numeric matrix or data.frame of enhancer expression
(rows = loci, cols = samples). Row names must be genomic coordinates in the
form \code{chr:start-end}.}

\item{GH.saf}{A data.frame with at least the columns \code{Chr}, \code{Start},
\code{End}, and \code{GeneID} describing GeneHancer regions.}

\item{collapse.rows}{Logical; if \code{TRUE} (default), rows that map to the
same \code{GeneID} are collapsed via trimmed mean (\code{trim = 0.1}).}
}
\value{
A numeric data.frame:
\itemize{
  \item If \code{collapse.rows = TRUE}: rownames are \code{GeneID}, columns are samples.
  \item If \code{collapse.rows = FALSE}: rownames are \code{GeneID} (must be unique),
        columns are samples; errors if duplicates would occur.
}
}
\description{
Takes an enhancer expression matrix whose rownames are genomic loci
(e.g. \code{"chr1:12345-12500"}) and maps each locus to GeneHancer
regions provided in a SAF-like table (columns: \code{Chr, Start, End, GeneID}).
Optionally collapses rows that map to the same GeneHancer ID using a
trimmed mean (10% trim).
}
\details{
Many loci can overlap the same GeneHancer region. With \code{collapse.rows = TRUE},
values for all loci mapping to the same \code{GeneID} are aggregated per sample using
\code{mean(x, trim = 0.1)} for robustness. With \code{collapse.rows = FALSE}, the
function requires a one-to-one mapping between input loci and \code{GeneID}.
}
\examples{
\dontrun{
# enhancer.exp rownames like "chr1:1000-1200"
res <- exp.loci2Ghid(enhancer.exp, GH.saf, collapse.rows = TRUE)
}

}
