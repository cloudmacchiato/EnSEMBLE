% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ssEA.R
\name{link_ESEA_GSEA_results}
\alias{link_ESEA_GSEA_results}
\title{Link GSEA and ESEA results using Fisher overlaps}
\usage{
link_ESEA_GSEA_results(
  ESEA_results,
  GSEA_results,
  fisher_results,
  top_n_ESEA = 10,
  top_n_GSEA = 15,
  signed_qValue_cutoff = NULL,
  fisher_padj_cutoff = 0.1,
  fdr_cutoff = 0.001,
  edge_width_range = c(0.6, 3.2),
  left_size_range = c(4, 12),
  right_node_size = 6,
  label_nudge = 0.03,
  label_size = 3,
  edge_alpha = 0.35,
  edge_color = "grey82",
  left_colors = c(neg = "#1F77B4", pos = "#D62728"),
  title = "Bipartite network of significant enrichments",
  subtitle = "Edges shown for FDR â‰¤ \%s"
)
}
\arguments{
\item{ESEA_results}{Data frame with enhancer-set level enrichment results. Must include
\code{Compare.List} and either \code{qValue} or \code{signed_qValue}.}

\item{GSEA_results}{Data frame with pathway level enrichment results. Must include
\code{Compare.List} and \code{NES}.}

\item{fisher_results}{Data frame containing Fisher overlap results with columns
\code{enh_set}, \code{gene_set}, and \code{p_adj}.}

\item{top_n_ESEA}{Integer indicating how many enhancer sets (ordered by \code{qValue})
to retain. Use \code{NULL} to keep all after filtering.}

\item{top_n_GSEA}{Integer indicating how many pathways (ordered by absolute \code{NES})
to retain. Use \code{NULL} to keep all.}

\item{signed_qValue_cutoff}{Optional numeric threshold applied on \code{abs(signed_qValue)}
before ranking by \code{qValue}.}

\item{fisher_padj_cutoff}{Numeric threshold applied to \code{p_adj} before constructing the
matrix (default \code{0.1}).}

\item{fdr_cutoff}{Numeric edge-level FDR cutoff applied after matrix construction (default \code{1e-3}).}

\item{edge_width_range}{Numeric vector of length two controlling edge thickness in the plot.}

\item{left_size_range}{Numeric vector of length two controlling the size range for GSEA nodes.}

\item{right_node_size}{Numeric scalar controlling the size of enhancer-set nodes.}

\item{label_nudge}{Horizontal offset applied to node labels.}

\item{label_size}{Size for node labels.}

\item{edge_alpha}{Alpha level for edges in the plot.}

\item{edge_color}{Edge colour used in the plot.}

\item{left_colors}{Named vector with colours for negative/positive NES nodes.}

\item{title}{Optional plot title.}

\item{subtitle}{Optional plot subtitle. Placeholders like `%s` are replaced with the FDR cutoff.}
}
\value{
A list with the following elements:
\describe{
  \item{fisher_matrix}{Numeric matrix used to build the network (rows = enhancer sets, columns = pathways).}
  \item{edges}{Data frame with edges that pass the FDR cutoff.}
  \item{nodes}{Data frame with node metadata and plotting coordinates.}
  \item{selected_ESEA}{Filtered enhancer-set results used in the network.}
  \item{selected_GSEA}{Filtered pathway results used in the network.}
  \item{plot}{A \code{ggplot2} object (or \code{NULL} when no edges pass the cutoff).}
}
}
\description{
Connects the top enhancer sets from ESEA with the most prominent pathways from GSEA
by leveraging Fisher overlap results. The function filters each input, constructs a
bipartite adjacency matrix, and optionally generates a publication-ready network plot.
}
\examples{
\dontrun{
result <- link_ESEA_GSEA_results(ESEA_results_selected_unique,
                                 GSEA_results_selected_unique,
                                 fisher_res)
print(result$plot)
}

}
