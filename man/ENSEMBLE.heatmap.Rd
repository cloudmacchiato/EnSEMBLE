% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pairwise_analysis.R
\name{ENSEMBLE.heatmap}
\alias{ENSEMBLE.heatmap}
\title{Plot Heatmap for eRNA Matrix or Enhancer Set Score Matrix}
\usage{
ENSEMBLE.heatmap(
  enhancer.matrix,
  scale = "row",
  cluster_rows = T,
  cluster_cols = T,
  show_rownames = T,
  show_colnames = T,
  filter.percent = NA,
  ann_col = NA,
  ann_row = NA,
  fontsize_row = 3,
  fontsize_col = 3
)
}
\arguments{
\item{enhancer.matrix}{A numeric matrix or data frame with eRNA expression or enhancer scores.
Row names should represent eRNA identifiers or enhancer setnames. Columns are samples.}

\item{scale}{A character string specifying the type of scaling to apply.
Options are \code{"row"}, \code{"col"}, or \code{"both"}. Default is \code{"row"}.}

\item{cluster_rows}{Logical indicating whether to cluster rows in the heatmap.
Default is \code{TRUE}.}

\item{cluster_cols}{Logical indicating whether to cluster columns in the heatmap.
Default is \code{TRUE}.}

\item{show_rownames}{Logical indicating whether to display row names in the heatmap.
Default is \code{TRUE}.}

\item{show_colnames}{Logical indicating whether to display column names in the heatmap.
Default is \code{TRUE}.}

\item{filter.percent}{Numeric value between 0 and 1.
If provided, only the top \code{filter.percent * 100} percent most variable rows are retained.}

\item{ann_col}{Optional annotations for columns (a data frame or list). Default is \code{NA}.}

\item{ann_row}{Optional annotations for rows (a data frame or list). Default is \code{NA}.}

\item{fontsize_row}{Numeric value for the row font size in the heatmap. Default is \code{3}.}

\item{fontsize_col}{Numeric value for the column font size in the heatmap. Default is \code{3}.}
}
\value{
A heatmap is generated using the \code{pheatmap} package.
}
\description{
Generates a heatmap for an eRNA expression or enhancer set score matrix.
Optionally filters to keep only the top most variable rows based on a specified quantile.
}
\details{
If \code{filter.percent} is specified, the function converts the input matrix to a data.table,
computes the variance for each row (excluding the identifier column), and retains only rows with variance
above the specified quantile threshold. The matrix is then scaled according to the \code{scale} argument,
and a heatmap is generated with a custom color palette and breakpoints.
}
